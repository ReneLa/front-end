{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/mac/Projects/React js/House /HouseAssist/frontend/components/landlord/house/create/AddHouseImage.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation ADD_IMAGE_MUTATION($image: String!, $houseId: ID!) {\\n    createHouseImage(image: $image, houseId: $houseId) {\\n      id\\n      image\\n      houseId {\\n        id\\n        house_heading\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React from \"react\";\nimport { withStyles, fade } from \"@material-ui/core/styles\";\nimport { Mutation } from \"react-apollo\";\nimport { Select, FormControl, Typography } from \"@material-ui/core\";\nimport gql from \"graphql-tag\";\nimport { theme as customTheme } from \"../../../Page\";\nimport { GET_USER_HOUSES } from \"../../../queryComponents/Houses\";\nimport Houses from \"../../../queryComponents/Houses\";\nimport { Container, FlatButton, Input } from \"../../../styledComponents\";\nimport AddPhotoIcon from \"@material-ui/icons/AddPhotoAlternate\";\nimport loadingImg from \"../../../../public/static/126.gif\";\nvar ADD_IMAGE_MUTATION = gql(_templateObject());\n\nvar styles = function styles(theme) {\n  return {\n    list: {\n      width: \"100%\",\n      alignItems: \"center\"\n    },\n    formControl: {\n      // marginTop: theme.spacing(2),\n      maxWidth: 200\n    },\n    button: {\n      margin: theme.spacing(1)\n    },\n    input: {\n      display: \"none\"\n    }\n  };\n};\n\nvar AddHouseImage = /*#__PURE__*/function (_React$Component) {\n  _inherits(AddHouseImage, _React$Component);\n\n  var _super = _createSuper(AddHouseImage);\n\n  function AddHouseImage() {\n    var _this;\n\n    _classCallCheck(this, AddHouseImage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      image: null,\n      houseId: \"\"\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleChange\", function (e) {\n      _this.setState(_defineProperty({}, e.target.name, e.target.value));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"uploadImage\", function _callee(e) {\n      var files, data, res, file;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              files = e.target.files;\n              data = new FormData();\n              data.append(\"file\", files[0]);\n              data.append(\"upload_preset\", \"house_assist\");\n              _context.next = 6;\n              return _regeneratorRuntime.awrap(fetch(\"https://api.cloudinary.com/v1_1/dsubmyluz/image/upload/\", {\n                method: \"POST\",\n                body: data\n              }));\n\n            case 6:\n              res = _context.sent;\n              _context.next = 9;\n              return _regeneratorRuntime.awrap(res.json());\n\n            case 9:\n              file = _context.sent;\n\n              if (file) {\n                _this.setState({\n                  image: file.secure_url\n                });\n              }\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"addImageContainer\", function (data) {\n      var _this$state = _this.state,\n          image = _this$state.image,\n          houseId = _this$state.houseId;\n      var classes = _this.props.classes;\n      return __jsx(Mutation, {\n        mutation: ADD_IMAGE_MUTATION,\n        variables: _this.state,\n        refetchQueries: [{\n          query: GET_USER_HOUSES\n        }],\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 7\n        }\n      }, function (addImage, _ref) {\n        var loading = _ref.loading,\n            error = _ref.error;\n        return __jsx(Container, {\n          flex: 1,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 13\n          }\n        }, __jsx(\"form\", {\n          method: \"post\",\n          style: {\n            width: \"100%\",\n            display: \"flex\",\n            flexDirection: \"column\",\n            flex: 1\n          },\n          onSubmit: function _callee2(e) {\n            return _regeneratorRuntime.async(function _callee2$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    e.preventDefault();\n                    _context2.next = 3;\n                    return _regeneratorRuntime.awrap(addImage());\n\n                  case 3:\n                    _this.setState({\n                      image: null,\n                      houseId: \"\"\n                    });\n\n                  case 4:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, null, null, null, Promise);\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 15\n          }\n        }, __jsx(Container, {\n          middle: true,\n          row: true,\n          center: true,\n          customStyles: {\n            paddingTop: 15,\n            marginTop: 30\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 17\n          }\n        }, __jsx(\"span\", {\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 19\n          }\n        }, \" Select House:\"), __jsx(FormControl, {\n          size: \"small\",\n          variant: \"outlined\",\n          className: classes.formControl,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 19\n          }\n        }, __jsx(Select, {\n          \"native\": true,\n          size: \"normal\",\n          value: houseId,\n          style: {\n            marginLeft: 15\n          },\n          onChange: function onChange(e) {\n            _this.setState({\n              houseId: e.target.value\n            });\n          },\n          inputProps: {\n            name: \"house\",\n            id: \"outlined-house-image\"\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 21\n          }\n        }, __jsx(\"option\", {\n          value: \"\",\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 23\n          }\n        }, \"choose house\"), data.map(function (house) {\n          return __jsx(\"option\", {\n            key: house.id,\n            value: house.id,\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 25\n            }\n          }, house.house_heading);\n        })))), __jsx(Container, {\n          middle: true,\n          row: true,\n          center: true,\n          customStyles: {\n            paddingTop: 15,\n            marginTop: 30\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 17\n          }\n        }, __jsx(\"span\", {\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 19\n          }\n        }, \" Select photo:\"), __jsx(Input, {\n          accept: \"image/*\",\n          id: \"text-button-file\",\n          multiple: true,\n          type: \"file\",\n          onChange: _this.uploadImage,\n          style: {\n            marginLeft: 10,\n            width: 200\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 19\n          }\n        }), image !== null && __jsx(\"img\", {\n          src: image,\n          style: {\n            width: 40,\n            height: 35,\n            objectFit: \"fit\"\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 21\n          }\n        })), __jsx(Container, {\n          right: true,\n          center: true,\n          row: true,\n          flex: 1,\n          space: \"space-between\",\n          customStyles: {\n            position: \"absolute\",\n            bottom: 0,\n            marginTop: 15,\n            padding: 10,\n            borderTop: \"0.5px solid \".concat(fade(\"#393939\", 0.2)),\n            width: \"100%\"\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 17\n          }\n        }, __jsx(FlatButton, {\n          type: \"submit\",\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 19\n          }\n        }, loading ? __jsx(\"img\", {\n          src: loadingImg,\n          style: {\n            width: 20,\n            height: 20\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 23\n          }\n        }) : \"Save\"))));\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(AddHouseImage, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state2 = this.state,\n          image = _this$state2.image,\n          houseId = _this$state2.houseId;\n      var classes = this.props.classes;\n      return __jsx(Container, {\n        flex: 1,\n        column: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 7\n        }\n      }, __jsx(Houses, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 9\n        }\n      }, function (_ref2) {\n        var data = _ref2.data,\n            loading = _ref2.loading,\n            error = _ref2.error;\n\n        if (data) {\n          var houses = data.getUserHouses;\n\n          if (houses.length === 0) {\n            return __jsx(Container, {\n              flex: 1,\n              column: true,\n              middle: true,\n              center: true // customStyles={{ paddingTop: 64 }}\n              ,\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 19\n              }\n            }, __jsx(AddPhotoIcon, {\n              style: {\n                fontSize: 60,\n                color: \"gray\"\n              },\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 214,\n                columnNumber: 21\n              }\n            }), __jsx(Typography, {\n              style: {\n                fontSize: 13,\n                fontWeight: 200,\n                marginTop: 20\n              },\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 21\n              }\n            }, \"Add at least one house\"));\n          }\n\n          if (houses.length !== 0) {\n            return __jsx(Container, {\n              color: \"pink\",\n              flex: 1,\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 19\n              }\n            }, _this2.addImageContainer(houses));\n          }\n        }\n\n        if (loading) {\n          return __jsx(Container, {\n            flex: 1,\n            middle: true,\n            center: true,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 17\n            }\n          }, __jsx(\"img\", {\n            src: loadingImg,\n            style: {\n              width: 25,\n              height: 25\n            },\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 19\n            }\n          }));\n        }\n\n        return null;\n      }));\n    }\n  }]);\n\n  return AddHouseImage;\n}(React.Component);\n\nexport default withStyles(styles)(AddHouseImage);","map":{"version":3,"sources":["/Users/mac/Projects/React js/House /HouseAssist/frontend/components/landlord/house/create/AddHouseImage.js"],"names":["React","withStyles","fade","Mutation","Select","FormControl","Typography","gql","theme","customTheme","GET_USER_HOUSES","Houses","Container","FlatButton","Input","AddPhotoIcon","loadingImg","ADD_IMAGE_MUTATION","styles","list","width","alignItems","formControl","maxWidth","button","margin","spacing","input","display","AddHouseImage","image","houseId","e","setState","target","name","value","files","data","FormData","append","fetch","method","body","res","json","file","secure_url","state","classes","props","query","addImage","loading","error","flexDirection","flex","preventDefault","paddingTop","marginTop","marginLeft","id","map","house","house_heading","uploadImage","height","objectFit","position","bottom","padding","borderTop","houses","getUserHouses","length","fontSize","color","fontWeight","addImageContainer","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { withStyles, fade } from \"@material-ui/core/styles\";\nimport { Mutation } from \"react-apollo\";\nimport { Select, FormControl, Typography } from \"@material-ui/core\";\nimport gql from \"graphql-tag\";\nimport { theme as customTheme } from \"../../../Page\";\nimport { GET_USER_HOUSES } from \"../../../queryComponents/Houses\";\nimport Houses from \"../../../queryComponents/Houses\";\nimport { Container, FlatButton, Input } from \"../../../styledComponents\";\nimport AddPhotoIcon from \"@material-ui/icons/AddPhotoAlternate\";\nimport loadingImg from \"../../../../public/static/126.gif\";\n\nconst ADD_IMAGE_MUTATION = gql`\n  mutation ADD_IMAGE_MUTATION($image: String!, $houseId: ID!) {\n    createHouseImage(image: $image, houseId: $houseId) {\n      id\n      image\n      houseId {\n        id\n        house_heading\n      }\n    }\n  }\n`;\n\nconst styles = theme => ({\n  list: {\n    width: \"100%\",\n    alignItems: \"center\"\n  },\n  formControl: {\n    // marginTop: theme.spacing(2),\n    maxWidth: 200\n  },\n  button: {\n    margin: theme.spacing(1)\n  },\n  input: {\n    display: \"none\"\n  }\n});\n\nclass AddHouseImage extends React.Component {\n  state = {\n    image: null,\n    houseId: \"\"\n  };\n  handleChange = e => {\n    this.setState({ [e.target.name]: e.target.value });\n  };\n  uploadImage = async e => {\n    const files = e.target.files;\n    const data = new FormData();\n    data.append(\"file\", files[0]);\n    data.append(\"upload_preset\", \"house_assist\");\n\n    const res = await fetch(\n      \"https://api.cloudinary.com/v1_1/dsubmyluz/image/upload/\",\n      {\n        method: \"POST\",\n        body: data\n      }\n    );\n    const file = await res.json();\n\n    if (file) {\n      this.setState({\n        image: file.secure_url\n      });\n    }\n  };\n\n  addImageContainer = data => {\n    const { image, houseId } = this.state;\n    const { classes } = this.props;\n    return (\n      <Mutation\n        mutation={ADD_IMAGE_MUTATION}\n        variables={this.state}\n        refetchQueries={[{ query: GET_USER_HOUSES }]}\n      >\n        {(addImage, { loading, error }) => {\n          return (\n            <Container flex={1}>\n              <form\n                method=\"post\"\n                style={{\n                  width: \"100%\",\n                  display: \"flex\",\n                  flexDirection: \"column\",\n                  flex: 1\n                }}\n                onSubmit={async e => {\n                  e.preventDefault();\n                  await addImage();\n                  this.setState({ image: null, houseId: \"\" });\n                }}\n              >\n                <Container\n                  middle\n                  row\n                  center\n                  customStyles={{ paddingTop: 15, marginTop: 30 }}\n                >\n                  <span> Select House:</span>\n                  <FormControl\n                    size=\"small\"\n                    variant=\"outlined\"\n                    className={classes.formControl}\n                  >\n                    <Select\n                      native\n                      size=\"normal\"\n                      value={houseId}\n                      style={{\n                        marginLeft: 15\n                      }}\n                      onChange={e => {\n                        this.setState({ houseId: e.target.value });\n                      }}\n                      inputProps={{\n                        name: \"house\",\n                        id: \"outlined-house-image\"\n                      }}\n                    >\n                      <option value=\"\">choose house</option>\n                      {data.map(house => (\n                        <option key={house.id} value={house.id}>\n                          {house.house_heading}\n                        </option>\n                      ))}\n                    </Select>\n                  </FormControl>\n                </Container>\n\n                <Container\n                  middle\n                  row\n                  center\n                  customStyles={{ paddingTop: 15, marginTop: 30 }}\n                >\n                  <span> Select photo:</span>\n                  <Input\n                    accept=\"image/*\"\n                    id=\"text-button-file\"\n                    multiple\n                    type=\"file\"\n                    onChange={this.uploadImage}\n                    style={{ marginLeft: 10, width: 200 }}\n                  />\n                  {image !== null && (\n                    <img\n                      src={image}\n                      style={{\n                        width: 40,\n                        height: 35,\n                        objectFit: \"fit\"\n                      }}\n                    />\n                  )}\n                </Container>\n\n                {/* action footer */}\n\n                <Container\n                  right\n                  center\n                  row\n                  flex={1}\n                  space=\"space-between\"\n                  customStyles={{\n                    position: \"absolute\",\n                    bottom: 0,\n                    marginTop: 15,\n                    padding: 10,\n                    borderTop: `0.5px solid ${fade(\"#393939\", 0.2)}`,\n                    width: \"100%\"\n                  }}\n                >\n                  <FlatButton type=\"submit\">\n                    {loading ? (\n                      <img src={loadingImg} style={{ width: 20, height: 20 }} />\n                    ) : (\n                      \"Save\"\n                    )}\n                  </FlatButton>\n                </Container>\n              </form>\n            </Container>\n          );\n        }}\n      </Mutation>\n    );\n  };\n  render() {\n    const { image, houseId } = this.state;\n    const { classes } = this.props;\n\n    return (\n      <Container flex={1} column>\n        <Houses>\n          {({ data, loading, error }) => {\n            if (data) {\n              const houses = data.getUserHouses;\n              if (houses.length === 0) {\n                return (\n                  <Container\n                    flex={1}\n                    column\n                    middle\n                    center\n                    // customStyles={{ paddingTop: 64 }}\n                  >\n                    <AddPhotoIcon style={{ fontSize: 60, color: \"gray\" }} />\n\n                    <Typography\n                      style={{\n                        fontSize: 13,\n                        fontWeight: 200,\n                        marginTop: 20\n                      }}\n                    >\n                      Add at least one house\n                    </Typography>\n                  </Container>\n                );\n              }\n              if (houses.length !== 0) {\n                return (\n                  <Container color=\"pink\" flex={1}>\n                    {this.addImageContainer(houses)}\n                  </Container>\n                );\n              }\n            }\n            if (loading) {\n              return (\n                <Container flex={1} middle center>\n                  <img src={loadingImg} style={{ width: 25, height: 25 }} />\n                </Container>\n              );\n            }\n            return null;\n          }}\n        </Houses>\n      </Container>\n    );\n  }\n}\n\nexport default withStyles(styles)(AddHouseImage);\n"]},"metadata":{},"sourceType":"module"}